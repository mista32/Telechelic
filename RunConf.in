units           lj
atom_style      full
special_bonds   fene

read_data       ../Init/Final.dat

neighbor        0.5 bin
neigh_modify    every 1 delay 0 check yes

kspace_style    pppm/cg 1.0e-5
pair_style      hybrid lj/cut 2.5 lj/cut/coul/long 2.5 6.5
pair_modify     shift yes
dielectric      0.028
pair_coeff      1 1 lj/cut 1.0 1.0 2.5
pair_coeff      1 2 lj/cut 1.0 1.0 2.5
pair_coeff      1 3 lj/cut 1.0 0.75 1.875
pair_coeff      2 2 lj/cut/coul/long 1.0 1.0 2.5
pair_coeff      2 3 lj/cut/coul/long 1.0 0.75 1.875
pair_coeff      3 3 lj/cut/coul/long 1.0 0.5 1.25

bond_style      fene
bond_coeff      1 30.0 1.5 1.0 1.0

variable        Lx equal "lx"
print           "" file Basic.txt screen no
print           "26000 25000 50 500" append Basic.txt screen no
print           "" append Basic.txt screen no
print           "2000 1000 1000" append Basic.txt screen no
print           "" append Basic.txt screen no
print           "${Lx}" append Basic.txt screen no
print           "" append Basic.txt screen no
print           "40.0 200000.0 0.4 2000.0 0.005 25.0" append Basic.txt screen no
print           "" append Basic.txt screen no
print           "0.01" append Basic.txt screen no

velocity        all create 1.5 297015 dist gaussian mom yes loop all

fix             1 all nvt temp 1.5 1.5 0.5

timestep        0.005

restart         400000 Restart1.lmp Restart2.lmp

thermo          400000

run             40000000 upto

variable        Step equal "step"
variable        Temp equal "temp"
variable        Press equal "press"
variable        Epair equal "epair"
variable        Evdwl equal "evdwl"
variable        Ecoul equal "ecoul"
variable        Elong equal "elong"
variable        Ebond equal "ebond"
variable        Eangle equal "eangle"
variable        PE equal "pe"
variable        Pxx equal "pxx"
variable        Pxy equal "pxy"
variable        Pxz equal "pxz"
variable        Pyy equal "pyy"
variable        Pyz equal "pyz"
variable        Pzz equal "pzz"
fix             3 all print 4000 "${Step} ${Temp} ${Press} ${Epair} ${Evdwl} ${Ecoul} ${Elong} ${Ebond} ${Eangle} ${PE}" file log.Thermo screen no title "step temp press epair evdwl ecoul elong ebond eangle pe"
fix             4 all print 2 "${Step} ${Pxx} ${Pxy} ${Pxz} ${Pyy} ${Pyz} ${Pzz}" file log.Tensor screen no title "Step Pxx Pxy Pxz Pyy Pyz Pzz"
dump            1 all dcd 8000 CoordL.dcd
dump_modify     1 flush yes unwrap yes
run             80000000 upto
undump          1
unfix           3
unfix           4

dump            2 all dcd 80 CoordM.dcd
dump_modify     2 flush yes unwrap yes
run             80400000 upto
undump          2

dump            3 all dcd 1 CoordS.dcd
dump_modify     3 flush yes unwrap yes
run             80405000 upto
undump          3

write_data      Final.dat nocoeff
